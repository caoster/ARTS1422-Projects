<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Fire Station</title>
</head>

<body>
<div style="width: 1000px; height: 800px;">
    <svg width="1000" height="800"></svg>
</div>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-geo-projection.v3.min.js"></script>
<script>
    const svg = d3.select("svg"),
        width = +svg.attr("width"),
        height = +svg.attr("height");

    const x_move_factor = width / 2;
    const y_move_factor = height / 2;

    const gfg = d3
        .geoMercator()
        .scale(width * 20)
        .rotate([0, 0])
        .center([119.5, 29.9])
        .translate([0, 0]);

    g = svg.append("g")
        .attr("transform", `translate(${x_move_factor},${y_move_factor})`);

    d3.json(
        "../data/geojson.json",
        function (data) {
            g.append("image")
                .attr('id', 'map')
                .attr("xlink:href", "map.jpg")
                .attr("transform", `translate(${-width},${-height}) scale(0.5)`);

            g.selectAll("path").data(data.features).enter().append("path") /* data.features to fill */
                .attr("fill", "#FFFFFF")
                .attr("fill-opacity", "0.2")
                .attr("d", d3.geoPath().projection(gfg))
                .style("stroke", "#000000")
                .style("stroke-width", "0.3px");

            // g.selectAll(".pin").data(places).enter().append("circle")
            //                 .attr("r", 5)
            //     .attr("transform", function (d) {
            //         return "translate(" + projection([
            //             d.location.longitude,
            //             d.location.latitude
            //         ]) + ")";
            //     });

            // TODO: display fire station here

        });

    console.log(gfg.invert([1000, 800]));
    console.log(gfg.invert([-1000, -800]));

    let zoom = d3.zoom()
        .scaleExtent([1, 1.5])
        .translateExtent([[-width / 2, -height / 2], [width * 3 / 2, height * 3 / 2]])
        .on("zoom", function () {
            g.attr("transform", `translate(${d3.event.transform.x + x_move_factor},${d3.event.transform.y + y_move_factor}) scale(${d3.event.transform.k})`);
        })

    svg.call(zoom);

</script>
</body>
</html>
